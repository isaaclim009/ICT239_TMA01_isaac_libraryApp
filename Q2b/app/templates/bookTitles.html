{% extends 'sidebar.html' %}

{% block title %}{{ config.TITLES.home }}{% endblock %}

{% block mobile_page_header %}BOOK TITLES{% endblock %}

{% block content %}
    <div class="bg-light bg-opacity-90 p-3 p-md-4 min-vh-100">
        <div class="d-none d-md-flex justify-content-center justify-content-md-between align-items-center mb-3 mb-md-4 px-2 px-md-3 py-2 rounded library-header">
            <h1 class="text-black mb-0 fs-3 fs-md-1">BOOK TITLES</h1>
        </div>
        
        <div class="d-flex justify-content-center">
            <div class="mb-3 mb-md-4 px-2 px-md-3 py-2 rounded library-info-box" style="width: 100%; max-width: 98%;">
                <div class="d-flex flex-column flex-sm-row justify-content-between align-items-start align-items-sm-center gap-2">
                    <span class="text-dark order-1 order-sm-1">Number of titles: {{ book_count }}</span>
                    <form method="POST" action="/" class="d-flex flex-row align-items-center gap-2 mb-0 order-2 order-sm-2 align-self-end align-self-sm-center">
                        <label for="category" class="form-label text-dark mb-0 text-nowrap">Category</label>
                        <select name="category" id="category" class="form-select" style="min-width: 120px; max-width: 150px;">
                            {% for value, label in categories %}
                            <option value="{{ value }}" {% if selected_category == value %}selected{% endif %}>{{ label }}</option>
                            {% endfor %}
                        </select>
                        <button type="submit" class="btn btn-success">Search</button>
                    </form>
                </div>
            </div>
        </div>
        
        <div class="d-flex flex-column align-items-center">
            {% for book in books %}
            <div class="card mb-3 mb-md-4">
                <div class="row g-0 align-items-start">
                <div class="col-12 col-sm-4 col-md-4 col-lg-2 d-flex justify-content-center align-items-start p-3 p-md-4">
                    <img src="{{ book.url }}" 
                         class="img-fluid rounded book-image" 
                         alt="{{ book.title }}">
                </div>
                
                <div class="col-12 col-sm-8 col-md-8 col-lg-10 d-flex flex-column">
                    <div class="card-body flex-grow-1">
                        <div class="card-title text-dark" style="font-weight:275; font-size:1.25rem;">
                            {{ book.title }}<br>
                            By {{ book.authors | join(', ') }}
                        </div>
                        <span style="display:block; height:0.5em;"></span>
                        
                        <p class="card-text text-dark mt-2 fs-6 lh-base">
                            Category: {{ book.category }}, {{ book.genres | join(', ') }}<br>
                            Pages: {{ book.pages }}
                        </p>
                        <span style="display:block; height:0.5em;"></span>
                        <p class="book-description">{{ book.description_preview|safe }}</p>
                    </div>
                    
                    <div class="d-flex justify-content-end p-3 p-md-4 pt-0">
                        <a href="{{ url_for('books.book_details', book_id=book.id) }}" 
                           class="btn btn-success" 
                           style="border-radius: 8px; padding: 0.5rem 1rem; margin-right: 1.5rem;">
                           More details
                        </a>
                    </div>
                </div>
            </div>
        </div>
        {% endfor %}
    </div>
{% endblock %}